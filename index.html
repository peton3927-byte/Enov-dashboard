<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enov Clan Admin Panel</title>
<style>
:root {
  --bg:#0a0a0a; --card:#111; --accent:#00ffee; --text:#fff;
}
body{margin:0;padding:0;font-family:'Poppins',sans-serif;background:var(--bg);color:var(--text);}
#app{width:100%;height:100%;}
header{background:var(--card);padding:1rem;display:flex;justify-content:center;align-items:center;}
header h1{color:var(--accent);}
main{padding:1rem;}
section{margin-bottom:1rem;}
.card{background:var(--card);padding:1rem;border-radius:12px;margin-bottom:1rem;}
button{background:var(--accent);border:none;color:#000;padding:.5rem 1rem;border-radius:12px;margin:.2rem;cursor:pointer;}
input, select{width:90%;padding:.4rem;margin:.3rem 0;border-radius:8px;border:none;background:#1a1a1a;color:#fff;}
.member{display:flex;justify-content:space-between;padding:.5rem;background:#1a1a1a;margin:.3rem 0;border-radius:8px;font-size:.9rem;}
#loginOverlay{position:absolute;top:0;left:0;width:100%;height:100%;background:#000c;display:flex;justify-content:center;align-items:center;z-index:100;}
#loginBox{background:var(--card);padding:2rem;border-radius:12px;text-align:center;}
#notification{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:var(--accent);color:#000;padding:.7rem 1rem;border-radius:12px;display:none;}
</style>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>

</head>
<body>
<div id="app">
  <header><h1>Enov Admin Panel</h1></header>

  <!-- Login Overlay -->
  <div id="loginOverlay">
    <div id="loginBox">
      <h2>üîí Admin Access</h2>
      <input type="password" id="accessCode" placeholder="Enter code">
      <button id="verifyBtn">Verify</button>
      <p id="error" style="color:red;display:none;">‚ùå Invalid Code</p>
    </div>
  </div>

  <main>
    <section>
      <h2>Clan Dashboard</h2>
      <div class="card" id="memberListCard">
        <div id="memberList"></div>
      </div>
    </section>

    <section>
      <h2>Admin Tools</h2>
      <div class="card">
        <select id="memberSelect"></select>
        <input type="number" id="pointsInput" placeholder="Points">
        <button id="addBtn">Add Points</button>
        <button id="removeBtn">Remove Points</button>
      </div>

      <div class="card">
        <select id="spendSelect"></select>
        <button data-type="admin">Unlock Admin (1000)</button>
        <button data-type="tournament">Host Tournament (500)</button>
      </div>
    </section>
  </main>

  <div id="notification"></div>
</div>

<script>
window.onload = function(){
  const loginOverlay=document.getElementById("loginOverlay");
  const verifyBtn=document.getElementById("verifyBtn");
  const errorMsg=document.getElementById("error");
  const memberList=document.getElementById("memberList");
  const memberSelect=document.getElementById("memberSelect");
  const spendSelect=document.getElementById("spendSelect");
  const pointsInput=document.getElementById("pointsInput");
  const notification=document.getElementById("notification");

  // Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyB-RGaKfSNNRRUMLnKMqdZaFjos_Gmcdp8",
    authDomain: "enovclanadmin.firebaseapp.com",
    databaseURL: "https://enovclanadmin.firebaseio.com",
    projectId: "enovclanadmin",
    storageBucket: "enovclanadmin.appspot.com",
    messagingSenderId: "1234567890",
    appId: "1:1234567890:web:abcdef123456"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let members = [];

  const membersRef = db.ref('members');

  // Listen for changes from Firebase
  membersRef.on('value', snapshot => {
    members = snapshot.val() || [];
    renderMembers();
  });

  function renderMembers(){
    memberList.innerHTML="";
    memberSelect.innerHTML="";
    spendSelect.innerHTML="";
    members.forEach((m,i)=>{
      memberList.innerHTML+=`<div class="member"><span>${m.name} | Lvl ${m.level} | Coins: ${m.coins} | Recruits: ${m.recruits}</span></div>`;
      memberSelect.innerHTML+=`<option value="${i}">${m.name}</option>`;
      spendSelect.innerHTML+=`<option value="${i}">${m.name}</option>`;
    });
  }

  function showNotification(msg){
    notification.innerText=msg;
    notification.style.display="block";
    setTimeout(()=>notification.style.display="none",2000);
  }

  function updateMember(idx){
    membersRef.child(idx).set(members[idx]);
  }

  // LOGIN
  verifyBtn.onclick = function(){
    if(document.getElementById("accessCode").value==="enov2025"){
      loginOverlay.style.display="none";
    } else {
      errorMsg.style.display="block";
      setTimeout(()=>errorMsg.style.display="none",2000);
    }
  };

  // ADD / REMOVE POINTS
  document.getElementById("addBtn").onclick = function(){
    let idx=memberSelect.value;
    let pts=parseInt(pointsInput.value);
    if(isNaN(pts)||pts<=0){alert("Enter a valid number"); return;}
    members[idx].coins+=pts;
    updateMember(idx);
    showNotification(`+${pts} coins to ${members[idx].name}`);
    pointsInput.value="";
  };
  document.getElementById("removeBtn").onclick = function(){
    let idx=memberSelect.value;
    let pts=parseInt(pointsInput.value);
    if(isNaN(pts)||pts<=0){alert("Enter a valid number"); return;}
    if(members[idx].coins>=pts){
      members[idx].coins-=pts;
      updateMember(idx);
      showNotification(`-${pts} coins from ${members[idx].name}`);
    } else alert("Not enough coins");
    pointsInput.value="";
  };

  // SPEND COINS
  document.querySelectorAll('button[data-type]').forEach(btn=>{
    btn.onclick=function(){
      let idx=spendSelect.value;
      let type=btn.dataset.type;
      if(type==="admin" && members[idx].coins>=1000){
        members[idx].coins-=1000; members[idx].level+=1; updateMember(idx);
        showNotification(`${members[idx].name} unlocked Admin!`);
      } else if(type==="tournament" && members[idx].coins>=500){
        members[idx].coins-=500; updateMember(idx);
        showNotification(`${members[idx].name} is hosting a tournament!`);
      } else alert("Not enough coins");
    }
  });

};
</script>
</body>
</html>
